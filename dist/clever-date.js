!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CleverDate=t():e.CleverDate=t()}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var u=t[n]={i:n,l:!1,exports:{}};return e[n].call(u.exports,u,u.exports,r),u.l=!0,u.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var u in e)r.d(n,u,function(t){return e[t]}.bind(null,u));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(r(1));e.exports=new u.default},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(r(2)),o=n(r(3)),a=n(r(5)),i=n(r(9)),f=n(r(10)),s=function(){function e(){this.items=[],this.rules=[]}return e.prototype.start=function(e){var t=this;void 0===e&&(e={});var r=this.mergeConfiguration(e),n=f.default.validate(r);if(n instanceof Error)throw n;var u=function(){t.extractItems(r.selector),t.analyse()};this.timer||(this.timer=this.startTimer(r.refresh,u)),this.rules=r.rules,u()},e.prototype.extractItems=function(e){var t=this;document.querySelectorAll("["+e+"]").forEach((function(r){var n=new u.default;n.reference=r,n.initialText=r.innerHTML;var o=r.getAttribute(e);if(!Number.isNaN(Number(o))){var a=parseInt(o,10);n.date=new Date(1e3*a),t.items.push(n)}r.removeAttribute(e),r.hasAttribute("title")||r.setAttribute("title",n.initialText)}))},e.prototype.analyse=function(){var e=this,t=new Date;this.items.filter((function(e){return!e.nextUpdate||e.nextUpdate<t})).forEach((function(t){e.manageItem(t)}))},e.prototype.manageItem=function(e){var t=o.default.getDateInterval(e.date),r=a.default.render(this.rules,t),n=function(t){e.reference.innerHTML!==t&&(e.reference.innerHTML=t)};r?(e.nextUpdate=r.nextUpdate,n(r.render)):n(e.initialText)},e.prototype.startTimer=function(e,t){return window.setInterval((function(){t()}),1e3*e)},e.prototype.mergeConfiguration=function(e){var t,r;return{refresh:(t=e.refresh,null!=t?t:i.default.refresh),selector:(r=e.selector,null!=r?r:i.default.selector),rules:e.rules?e.rules.concat(i.default.rules):i.default.rules}},e}();t.default=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){};t.default=n},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(r(4)),o=function(){function e(){}return e.prototype.getDateInterval=function(t){var r=new u.default,n=(Date.now()-t.getTime())/1e3;return r.date=t,r.day=Math.trunc(n/e.SECONDS_IN_DAY),n-=e.SECONDS_IN_DAY*r.day,r.hour=Math.trunc(n/e.SECONDS_IN_HOUR),n-=e.SECONDS_IN_HOUR*r.hour,r.minute=Math.trunc(n/e.SECONDS_IN_MINUTE),n-=e.SECONDS_IN_MINUTE*r.minute,r.second=Math.trunc(n),r},e.SECONDS_IN_DAY=86400,e.SECONDS_IN_HOUR=3600,e.SECONDS_IN_MINUTE=60,e}();t.default=new o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){};t.default=n},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(r(6)),o=function(){function e(){}return e.prototype.render=function(e,t){var r=e.find((function(e){return e.condition(t)}));if(!r)return null;var n=u.default.getLangName();return{render:this.parseRule(r.text[n],t),nextUpdate:this.calculateNextUpdate(r)}},e.prototype.parseRule=function(e,t){for(var r,n,u=e,o=/{%([a-z]+)\|([^|\[\]]*)\|([^|\[\]]*)}/gi;null!==(r=o.exec(e));){var a=this.getVariableValue(r[1],t);null!==a&&(u=u.replace(r[0],parseInt(a,10)<=1?r[2]:r[3]))}for(var i=/%([a-z]+)/gi;null!==(n=i.exec(e));){var f=this.getVariableValue(n[1],t);null!==f&&(u=u.replace(n[0],f))}return u.replace("\\","")},e.prototype.calculateNextUpdate=function(e){if(!e.refresh)return null;var t=new Date;return new Date(t.setTime(t.getTime()+1e3*e.refresh))},e.prototype.getVariableValue=function(e,t){switch(e){case"dd":return t.day.toString();case"dh":return t.hour.toString();case"dm":return t.minute.toString();case"ds":return t.second.toString();case"Y":return t.date.getFullYear().toString();case"d":return t.date.getDate().toString();case"l":return u.default.getDay(t.date.getDay());case"F":return u.default.getMonth(t.date.getMonth());case"G":return t.date.getHours().toString();case"H":return("0"+t.date.getHours()).slice(-2);case"i":return("0"+t.date.getMinutes()).slice(-2);default:return null}},e}();t.default=new o},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(r(7)),o=n(r(8)),a=function(){function e(){}return e.getDay=function(t){return e.getLang().days[t]},e.getMonth=function(t){return e.getLang().months[t]},e.getLang=function(){switch(e.getLangName()){case"fr":return u.default;case"en":default:return o.default}},e.getLangName=function(){var e=navigator.language;return e?e=e.split("-")[0]:"en"},e}();t.default=a},function(e){e.exports=JSON.parse('{"days":["dimanche","lundi","mardi","mercredi","eudi","vendredi","samedi"],"months":["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"]}')},function(e){e.exports=JSON.parse('{"days":["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],"months":["january","february","march","april","may","june","july","august","september","october","november","december"]}')},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={refresh:5,selector:"data-clever-date",rules:[{condition:function(e){return 0===e.day&&0===e.hour&&0===e.minute&&e.second>=0&&e.second<30},text:{fr:"à l'instant",en:"just now"}},{condition:function(e){return 0===e.day&&0===e.hour&&0===e.minute&&e.second>=0&&e.second<60},text:{en:"%ds second{%ds||s} ago",fr:"il y a %ds seconde{%ds||s}"}},{condition:function(e){return 0===e.day&&0===e.hour&&e.minute>=0&&e.minute<60},text:{en:"%dm minute{%dm||s} ago",fr:"il y a %dm minute{%dm||s}"}},{condition:function(e){return 0===e.day&&e.hour>0&&e.hour>=0&&e.hour<12},refresh:300,text:{en:"%dh hour[%dh||s] ago",fr:"il y a %dh heure{%dh||s}"}},{condition:function(e){return(new Date).toDateString()===e.date.toDateString()},refresh:60,text:{en:"today at %H:%i",fr:"aujourd'hui à %H\\h%i"}},{condition:function(e){var t=new Date,r=t.setDate(t.getDate()-1);return new Date(r).toDateString()===e.date.toDateString()},refresh:60,text:{en:"yesterday at %H:%i",fr:"hier à %H\\h%i"}},{condition:function(e){return e.day>0&&e.day<7},refresh:3600,text:{en:"%l at %H:%i",fr:"%l à %H\\h%i"}},{condition:function(e){return e.date.getFullYear()===(new Date).getFullYear()},refresh:1e5,text:{en:"%F %d",fr:"le %d{%d|er|} %F"}},{condition:function(){return!0},refresh:1e5,text:{en:"%F %d, %Y",fr:"le %d{%d|er|} %F %Y"}}]}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=new(function(){function e(){}return e.prototype.validate=function(e){if("number"!=typeof e.refresh)return new Error("Refresh value must be a number.");for(var t=0,r=e.rules;t<r.length;t++){var u=r[t];if(!u.condition||!u.text||"object"!==n(u.text))return new Error("A rule must be composed of a condition and a corresponding text keys.")}return null},e}())}])}));